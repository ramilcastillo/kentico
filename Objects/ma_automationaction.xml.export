<ma_automationaction version="12.0">
  <NewDataSet>
    <cms_workflowaction>
      <ActionID>136</ActionID>
      <ActionDisplayName>Send marketing email</ActionDisplayName>
      <ActionName>Send_newsletter_issue</ActionName>
      <ActionParameters>&lt;form version="2"&gt;&lt;field column="Site" columnsize="200" columntype="text" guid="32ab6762-e2a4-4750-b61a-7d91ff18f677" hasdependingfields="true" publicfield="false" visible="true"&gt;&lt;properties&gt;&lt;defaultvalue&gt;{% SiteContext.CurrentSiteName |(identity)GlobalAdministrator|(hash)d495e547f8933248b57eb9334187b84b3ff996e5c430ee5eb696ef38baa44d50%}&lt;/defaultvalue&gt;&lt;fieldcaption&gt;{$general.site$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$siteselect.selectitem$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AddGlobalObjectNamePrefix&gt;False&lt;/AddGlobalObjectNamePrefix&gt;&lt;AddGlobalObjectSuffix&gt;False&lt;/AddGlobalObjectSuffix&gt;&lt;AllowAll&gt;False&lt;/AllowAll&gt;&lt;AllowDefault&gt;False&lt;/AllowDefault&gt;&lt;AllowEditTextBox&gt;False&lt;/AllowEditTextBox&gt;&lt;AllowEmpty&gt;False&lt;/AllowEmpty&gt;&lt;controlname&gt;Uni_selector&lt;/controlname&gt;&lt;DialogWindowName&gt;SelectionDialog&lt;/DialogWindowName&gt;&lt;EditDialogWindowHeight&gt;700&lt;/EditDialogWindowHeight&gt;&lt;EditDialogWindowWidth&gt;1000&lt;/EditDialogWindowWidth&gt;&lt;EditWindowName&gt;EditWindow&lt;/EditWindowName&gt;&lt;EncodeOutput&gt;True&lt;/EncodeOutput&gt;&lt;GlobalObjectSuffix ismacro="true"&gt;{$general.global$}&lt;/GlobalObjectSuffix&gt;&lt;ItemsPerPage&gt;25&lt;/ItemsPerPage&gt;&lt;LocalizeItems&gt;True&lt;/LocalizeItems&gt;&lt;MaxDisplayedItems&gt;25&lt;/MaxDisplayedItems&gt;&lt;MaxDisplayedTotalItems&gt;50&lt;/MaxDisplayedTotalItems&gt;&lt;ObjectType&gt;cms.site&lt;/ObjectType&gt;&lt;RemoveMultipleCommas&gt;False&lt;/RemoveMultipleCommas&gt;&lt;ReturnColumnName&gt;SiteName&lt;/ReturnColumnName&gt;&lt;ReturnColumnType&gt;id&lt;/ReturnColumnType&gt;&lt;SelectionMode&gt;1&lt;/SelectionMode&gt;&lt;ValuesSeparator&gt;;&lt;/ValuesSeparator&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field column="Newsletter" columntype="guid" dependsonanotherfield="true" guid="4e59d0d5-d8b1-4199-a5c7-acb476cd4755" hasdependingfields="true" publicfield="false" visible="true"&gt;&lt;properties&gt;&lt;fieldcaption&gt;{$objecttype.newsletter_newsletter$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$newsletterselect.selectSingleItem$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AddGlobalObjectNamePrefix&gt;False&lt;/AddGlobalObjectNamePrefix&gt;&lt;AddGlobalObjectSuffix&gt;False&lt;/AddGlobalObjectSuffix&gt;&lt;AllowAll&gt;False&lt;/AllowAll&gt;&lt;AllowDefault&gt;False&lt;/AllowDefault&gt;&lt;AllowEditTextBox&gt;False&lt;/AllowEditTextBox&gt;&lt;AllowEmpty&gt;False&lt;/AllowEmpty&gt;&lt;controlname&gt;Uni_selector&lt;/controlname&gt;&lt;DialogWindowName&gt;SelectionDialog&lt;/DialogWindowName&gt;&lt;EditDialogWindowHeight&gt;700&lt;/EditDialogWindowHeight&gt;&lt;EditDialogWindowWidth&gt;1000&lt;/EditDialogWindowWidth&gt;&lt;EditWindowName&gt;EditWindow&lt;/EditWindowName&gt;&lt;EncodeOutput&gt;True&lt;/EncodeOutput&gt;&lt;GlobalObjectSuffix ismacro="true"&gt;{$general.global$}&lt;/GlobalObjectSuffix&gt;&lt;ItemsPerPage&gt;25&lt;/ItemsPerPage&gt;&lt;LocalizeItems&gt;True&lt;/LocalizeItems&gt;&lt;MaxDisplayedItems&gt;25&lt;/MaxDisplayedItems&gt;&lt;MaxDisplayedTotalItems&gt;50&lt;/MaxDisplayedTotalItems&gt;&lt;ObjectSiteName ismacro="true"&gt;{% Site.Value |(identity)GlobalAdministrator|(hash)531cc774607d2abee0b865fbd217b26f17abb752175b97812198cb331a63d49b%}&lt;/ObjectSiteName&gt;&lt;ObjectType&gt;newsletter.newsletter&lt;/ObjectType&gt;&lt;RemoveMultipleCommas&gt;False&lt;/RemoveMultipleCommas&gt;&lt;ReturnColumnName&gt;NewsletterGUID&lt;/ReturnColumnName&gt;&lt;ReturnColumnType&gt;id&lt;/ReturnColumnType&gt;&lt;SelectionMode&gt;1&lt;/SelectionMode&gt;&lt;SpecialFields&gt;00000000-0000-0000-0000-000000000000;{$general.pleaseselect$}&lt;/SpecialFields&gt;&lt;UseDefaultNameFilter&gt;True&lt;/UseDefaultNameFilter&gt;&lt;ValuesSeparator&gt;;&lt;/ValuesSeparator&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field column="NewsletterIssue" columntype="guid" dependsonanotherfield="true" guid="db1323bc-9e95-4b45-a8d9-3f11e3616530" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;fieldcaption&gt;{$newslettertemplate_list.issue$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.newsletterissue.description$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AddGlobalObjectNamePrefix&gt;False&lt;/AddGlobalObjectNamePrefix&gt;&lt;AddGlobalObjectSuffix&gt;False&lt;/AddGlobalObjectSuffix&gt;&lt;AllowAll&gt;False&lt;/AllowAll&gt;&lt;AllowDefault&gt;False&lt;/AllowDefault&gt;&lt;AllowEditTextBox&gt;False&lt;/AllowEditTextBox&gt;&lt;AllowEmpty&gt;False&lt;/AllowEmpty&gt;&lt;controlname&gt;Uni_selector&lt;/controlname&gt;&lt;DialogWindowHeight&gt;590&lt;/DialogWindowHeight&gt;&lt;DialogWindowName&gt;SelectionDialog&lt;/DialogWindowName&gt;&lt;FilterControl&gt;~/CMSFormControls/Filters/ObjectFilter.ascx&lt;/FilterControl&gt;&lt;GlobalObjectSuffix&gt;(global)&lt;/GlobalObjectSuffix&gt;&lt;ItemsPerPage&gt;25&lt;/ItemsPerPage&gt;&lt;LocalizeItems&gt;True&lt;/LocalizeItems&gt;&lt;MaxDisplayedItems&gt;25&lt;/MaxDisplayedItems&gt;&lt;MaxDisplayedTotalItems&gt;50&lt;/MaxDisplayedTotalItems&gt;&lt;ObjectSiteName ismacro="true"&gt;{% Site.Value |(identity)GlobalAdministrator|(hash)531cc774607d2abee0b865fbd217b26f17abb752175b97812198cb331a63d49b%}&lt;/ObjectSiteName&gt;&lt;ObjectType&gt;newsletter.issue&lt;/ObjectType&gt;&lt;RemoveMultipleCommas&gt;False&lt;/RemoveMultipleCommas&gt;&lt;ResourcePrefix&gt;newsletter.issue&lt;/ResourcePrefix&gt;&lt;ReturnColumnName&gt;IssueGUID&lt;/ReturnColumnName&gt;&lt;ReturnColumnType&gt;id&lt;/ReturnColumnType&gt;&lt;SelectionMode&gt;1&lt;/SelectionMode&gt;&lt;SpecialFields&gt;;{$general.pleaseselect$}&lt;/SpecialFields&gt;&lt;UseDefaultNameFilter&gt;True&lt;/UseDefaultNameFilter&gt;&lt;ValuesSeparator&gt;;&lt;/ValuesSeparator&gt;&lt;WhereCondition ismacro="true"&gt;COALESCE(IssueIsABTest, 0) = 0 AND 
IssueNewsletterID IN 
(
    Select NewsletterID FROM Newsletter_Newsletter 
    WHERE NewsletterGUID =  N'{% Newsletter.Value|(handlesqlinjection) |(identity)GlobalAdministrator|(hash)148ac54bb923d54da3d8956840fd8cc41235101171c61b7bb98e37955065478c%}'
)&lt;/WhereCondition&gt;&lt;/settings&gt;&lt;/field&gt;&lt;/form&gt;</ActionParameters>
      <ActionDescription>Using this step, you can send a marketing email to a contact automatically within the automation process.</ActionDescription>
      <ActionAssemblyName>CMS.Newsletters</ActionAssemblyName>
      <ActionClass>CMS.Newsletters.SendNewsletterIssueAction</ActionClass>
      <ActionGUID>b33d5c68-235d-406e-89d7-4f1714078940</ActionGUID>
      <ActionLastModified>2017-12-12T23:21:06.8139543+08:00</ActionLastModified>
      <ActionEnabled>true</ActionEnabled>
      <ActionAllowedObjects>;om.contact;</ActionAllowedObjects>
      <ActionWorkflowType>3</ActionWorkflowType>
      <ActionIconClass>icon-message</ActionIconClass>
      <ActionThumbnailClass>icon-message</ActionThumbnailClass>
    </cms_workflowaction>
    <cms_workflowaction>
      <ActionID>96</ActionID>
      <ActionDisplayName>Send transactional email</ActionDisplayName>
      <ActionName>Send_e-mail</ActionName>
      <ActionParameters>&lt;form version="2"&gt;&lt;field column="From" columnsize="256" columntype="text" guid="03d20e31-9f89-4954-a9ad-435a532dffdd" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;fieldcaption&gt;{$general.fromemail$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.from.desc$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AutoCompleteEnableCaching&gt;False&lt;/AutoCompleteEnableCaching&gt;&lt;AutoCompleteFirstRowSelected&gt;False&lt;/AutoCompleteFirstRowSelected&gt;&lt;AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;False&lt;/AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;&lt;controlname&gt;textboxcontrol&lt;/controlname&gt;&lt;FilterMode&gt;False&lt;/FilterMode&gt;&lt;Trim&gt;False&lt;/Trim&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field column="To" columntype="longtext" guid="b0d64701-e65c-42f5-897f-147e95628d4d" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;fieldcaption&gt;{$general.toemail$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.to.desc$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AutoCompleteEnableCaching&gt;False&lt;/AutoCompleteEnableCaching&gt;&lt;AutoCompleteFirstRowSelected&gt;False&lt;/AutoCompleteFirstRowSelected&gt;&lt;AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;False&lt;/AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;&lt;controlname&gt;textareacontrol&lt;/controlname&gt;&lt;FilterMode&gt;False&lt;/FilterMode&gt;&lt;IsTextArea&gt;True&lt;/IsTextArea&gt;&lt;Wrap&gt;True&lt;/Wrap&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field column="BasedOn" columntype="integer" guid="6cbde5ca-bf84-488b-9c7f-016caf5e2d44" hasdependingfields="true" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;defaultvalue&gt;0&lt;/defaultvalue&gt;&lt;fieldcaption&gt;{$ma.action.sendemails.basedon$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.basedon.desc$}&lt;/fielddescription&gt;&lt;/properties&gt;&lt;settings&gt;&lt;controlname&gt;RadioButtonsControl&lt;/controlname&gt;&lt;Options&gt;0;Email template
1;HTML formatted text&lt;/Options&gt;&lt;RepeatDirection&gt;horizontal&lt;/RepeatDirection&gt;&lt;RepeatLayout&gt;Flow&lt;/RepeatLayout&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field column="EmailTemplate" columnsize="450" columntype="text" guid="d9a2f538-e097-43b6-ae78-3d6fd6892ec4" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;enabledmacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;0&amp;quot;|(identity)GlobalAdministrator|(hash)d67b056e0b9043401f6027c7e8390421014f8829c36b2b2b22cdfafa9df21b58%}&lt;/enabledmacro&gt;&lt;fieldcaption&gt;{$ma.action.sendemails.template$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.template.desc$}&lt;/fielddescription&gt;&lt;validationerrormessage&gt;{$emailtemplate_edit.fillcodenamefield$}&lt;/validationerrormessage&gt;&lt;visiblemacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;0&amp;quot;|(identity)GlobalAdministrator|(hash)d67b056e0b9043401f6027c7e8390421014f8829c36b2b2b22cdfafa9df21b58%}&lt;/visiblemacro&gt;&lt;/properties&gt;&lt;settings&gt;&lt;controlname&gt;email_template_selector&lt;/controlname&gt;&lt;ShowEditButton&gt;True&lt;/ShowEditButton&gt;&lt;ShowNewButton&gt;True&lt;/ShowNewButton&gt;&lt;TemplateType&gt;automation&lt;/TemplateType&gt;&lt;/settings&gt;&lt;rules&gt;&lt;rule&gt;{%Rule(&amp;quot;Value.Length &amp;gt;= 1&amp;quot;, &amp;quot;&amp;lt;rules&amp;gt;&amp;lt;r pos=\&amp;quot;0\&amp;quot; par=\&amp;quot;\&amp;quot; op=\&amp;quot;and\&amp;quot; n=\&amp;quot;MinLength\&amp;quot; &amp;gt;&amp;lt;p n=\&amp;quot;minlength\&amp;quot;&amp;gt;&amp;lt;t&amp;gt;1&amp;lt;/t&amp;gt;&amp;lt;v&amp;gt;1&amp;lt;/v&amp;gt;&amp;lt;r&amp;gt;false&amp;lt;/r&amp;gt;&amp;lt;d&amp;gt;&amp;lt;/d&amp;gt;&amp;lt;vt&amp;gt;integer&amp;lt;/vt&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;/rules&amp;gt;&amp;quot;)|(identity)GlobalAdministrator|(hash)e8e2eb34c196b7b53f4147d8428898e5aaad06637024e6a8cf01ef56ffdf5ac5%}&lt;/rule&gt;&lt;rule&gt;{%Rule(&amp;quot;Value.Matches(\&amp;quot;^(?!\\\\s*$).+\&amp;quot;)&amp;quot;, &amp;quot;&amp;lt;rules&amp;gt;&amp;lt;r pos=\&amp;quot;0\&amp;quot; par=\&amp;quot;\&amp;quot; op=\&amp;quot;and\&amp;quot; n=\&amp;quot;RegExp\&amp;quot; &amp;gt;&amp;lt;p n=\&amp;quot;regexp\&amp;quot;&amp;gt;&amp;lt;t&amp;gt;^(?!\\s*$).+&amp;lt;/t&amp;gt;&amp;lt;v&amp;gt;^(?!\\s*$).+&amp;lt;/v&amp;gt;&amp;lt;r&amp;gt;0&amp;lt;/r&amp;gt;&amp;lt;d&amp;gt;&amp;lt;/d&amp;gt;&amp;lt;vt&amp;gt;text&amp;lt;/vt&amp;gt;&amp;lt;tv&amp;gt;0&amp;lt;/tv&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/r&amp;gt;&amp;lt;/rules&amp;gt;&amp;quot;)|(identity)GlobalAdministrator|(hash)f8423c9a07d38cf2e9c0b92a4e4622d66560922d84191e75fcb09cb891d7258b%}&lt;/rule&gt;&lt;/rules&gt;&lt;/field&gt;&lt;field allowempty="true" column="Subject" columnsize="998" columntype="text" guid="45595d6d-814f-4590-a079-6dd895f9edc0" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;enabledmacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;1&amp;quot;|(identity)GlobalAdministrator|(hash)1ffd2a1598aa65c66ee448d99180e2bf5d758f600b3e45ce321684c2ffd3e58c%}&lt;/enabledmacro&gt;&lt;fieldcaption&gt;{$general.subject$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.subject.desc$}&lt;/fielddescription&gt;&lt;visiblemacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;1&amp;quot;|(identity)GlobalAdministrator|(hash)1ffd2a1598aa65c66ee448d99180e2bf5d758f600b3e45ce321684c2ffd3e58c%}&lt;/visiblemacro&gt;&lt;/properties&gt;&lt;settings&gt;&lt;AutoCompleteEnableCaching&gt;False&lt;/AutoCompleteEnableCaching&gt;&lt;AutoCompleteFirstRowSelected&gt;False&lt;/AutoCompleteFirstRowSelected&gt;&lt;AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;False&lt;/AutoCompleteShowOnlyCurrentWordInCompletionListItem&gt;&lt;controlname&gt;textboxcontrol&lt;/controlname&gt;&lt;FilterMode&gt;False&lt;/FilterMode&gt;&lt;Trim&gt;False&lt;/Trim&gt;&lt;/settings&gt;&lt;/field&gt;&lt;field allowempty="true" column="Body" columntype="longtext" guid="f4ef4406-3691-44c1-9d02-8ad215c4ec24" publicfield="false" visibility="none" visible="true"&gt;&lt;properties&gt;&lt;enabledmacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;1&amp;quot;|(identity)GlobalAdministrator|(hash)1ffd2a1598aa65c66ee448d99180e2bf5d758f600b3e45ce321684c2ffd3e58c%}&lt;/enabledmacro&gt;&lt;fieldcaption&gt;{$general.body$}&lt;/fieldcaption&gt;&lt;fielddescription&gt;{$ma.action.sendemails.body.desc$}&lt;/fielddescription&gt;&lt;visiblemacro ismacro="true"&gt;{%BasedOn.Value == &amp;quot;1&amp;quot;|(identity)GlobalAdministrator|(hash)1ffd2a1598aa65c66ee448d99180e2bf5d758f600b3e45ce321684c2ffd3e58c%}&lt;/visiblemacro&gt;&lt;/properties&gt;&lt;settings&gt;&lt;Autoresize_Hashtable&gt;True&lt;/Autoresize_Hashtable&gt;&lt;controlname&gt;htmlareacontrol&lt;/controlname&gt;&lt;Dialogs_Content_Hide&gt;False&lt;/Dialogs_Content_Hide&gt;&lt;HeightUnitType&gt;PX&lt;/HeightUnitType&gt;&lt;MediaDialogConfiguration&gt;True&lt;/MediaDialogConfiguration&gt;&lt;ShowAddStampButton&gt;False&lt;/ShowAddStampButton&gt;&lt;WidthUnitType&gt;PX&lt;/WidthUnitType&gt;&lt;/settings&gt;&lt;/field&gt;&lt;/form&gt;</ActionParameters>
      <ActionDescription>Using this step, you can automatically send out email messages according to the step's properties, where you can specify the recipients and the template the emails will be based on.</ActionDescription>
      <ActionAssemblyName>CMS.Automation</ActionAssemblyName>
      <ActionClass>CMS.Automation.EmailAction</ActionClass>
      <ActionGUID>a578a254-b251-4f1e-abb7-533e5898f012</ActionGUID>
      <ActionLastModified>2017-03-03T20:33:32.997629+08:00</ActionLastModified>
      <ActionEnabled>true</ActionEnabled>
      <ActionAllowedObjects>;om.contact;</ActionAllowedObjects>
      <ActionWorkflowType>3</ActionWorkflowType>
      <ActionIconClass>icon-message</ActionIconClass>
      <ActionThumbnailClass>icon-message</ActionThumbnailClass>
    </cms_workflowaction>
  </NewDataSet>
</ma_automationaction>